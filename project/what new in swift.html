<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<title>what new in swift</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}
* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>


</head>

<body>

<h1 id="toc_0">what new in swift</h1>

<h2 id="toc_1">Goals for Swift 3</h2>

<blockquote>
<p>Swift å¼€æºå·²æœ‰6ä¸ªæœˆï¼Œå¼€æºç¤¾åŒºè®¨è®ºä»æœªåœæ­‡è¿‡ã€‚Swift3 çš„ç›®æ ‡æœ‰ä»¥ä¸‹4ç‚¹ï¼š</p>
</blockquote>

<div><pre><code class="language-none">1ã€å‘å±•å¼€æºç¤¾åŒº
2ã€æ–°å¹³å°çš„å¯ç§»æ¤æ€§
3ã€å¼€æ”¾æ›´å¤šåŸºç¡€åŠŸèƒ½
4ã€æŒç»­ä¼˜åŒ–</code></pre></div>

<h2 id="toc_2">Swift Adoption at Apple</h2>

<p>ç›®å‰å…¬å¸ƒçš„ Sierra macOS ç³»ç»Ÿä¸­ï¼Œå¤§éƒ¨åˆ† Misson Control éƒ½å·²ç»ä½¿ç”¨ Swift é‡å†™ï¼Œç”šè‡³ Accessibility å¼•æ“å®Œå…¨ä½¿ç”¨äº† Swiftã€‚</p>

<p>è¿™é‡ŒWWDCè¿˜ä¸¾äº†Dockçš„ä¸€ä¸ªğŸŒ°ï¼Œè®²è¿°å…³äºè¿™ä¸ª20ä¸‡è¡Œä»£ç çš„åº”ç”¨ä½¿ç”¨ Swift é‡å†™åä»£ç é‡å‡å°‘äº†15%ä¹‹å¤šï¼ŒåŒæ—¶åˆå¢åŠ äº†ä¸€äº›æ–°åŠŸèƒ½ã€‚</p>

<h2 id="toc_3">Swiftç¤¾åŒº</h2>

<p><img src="../images/session-402-1.png" alt=""></p>

<blockquote>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒApple å¼€æºäº† Swiftï¼Œå°†é¡¹ç›®æ‰˜ç®¡åˆ°äº† GitHubï¼Œé¡¹ç›®æœ‰å¾ˆå¤šï¼Œè­¬å¦‚ï¼šswiftã€swift-evolutionã€swift-package-managerã€swift-clangã€swift-corelibs-libdispatchç­‰ç­‰ã€‚ä¸è¿‡å®é™…å¯ä»¥åˆ’åˆ†ä¸ºä¸‰ç±»ï¼š</p>
</blockquote>

<div><pre><code class="language-none">Language:swift swift-evolution
Package Manager:swift-package-manager swift-llbuild
Core Libraries:swift-corelibs-xctest swift-corelibs-foundation swift-corelibs-libdispatch</code></pre></div>

<p>å…¶ä¸­package Manageræœ‰4ä¸ªç›®æ ‡</p>

<div><pre><code class="language-none">æ—©æœŸç§¯æå‘å±•
è·¨å¹³å°çš„è½¯ä»¶åŒ…
æ— å·®å¼‚çš„å‘å±•
åœ¨æœªæ¥çš„Xcodeé›†æˆ</code></pre></div>

<p>Core Librariesè¿™é‡Œä¸¾äº†ä¸€ä¸ªä¾‹å­ï¼Œä»‹ç»äº†Foundationè¿™ä¸ªCore libåœ¨linuxä¸Šå¯ä»¥ä½¿ç”¨äº†ï¼Œæš´éœ²çš„APIè™½ç„¶ä¸æ˜¯å¾ˆå¤šï¼Œä½†æ˜¯å‰æ™¯è¿˜æ˜¯ä¸å¯ä¼°é‡å•Šï¼Œç¬¬ä¸€æ­¥æ€»æ˜¯å›°éš¾çš„ï¼ï¼ï¼</p>

<p>å¦‚æœæƒ³äº†è§£çš„æ›´å¤šï¼Œå¯ä»¥å‰å¾€<a href="https://swift.org">Swift.org</a>ã€‚</p>

<p><img src="../images/session-402-2.png" alt=""></p>

<h2 id="toc_4">å¦‚ä½•å‚ä¸åˆ°Swift-Evalutionä¸­å»</h2>

<p>å¦‚æœä½ æƒ³è¦å¯¹ swift æå‡ºè‡ªå·±çš„æƒ³æ³•æˆ–æ„è§ï¼Œè¿™æ„å‘³ç€ evolutionï¼ŒApple ååˆ†æ¬¢è¿å¼€å‘è€…è¸Šè·ƒå‚ä¸ï¼Œä½†æ˜¯è²Œä¼¼å›½å†…å¾ˆå¤šå°ä¼™ä¼´ä¸æ˜¯å¾ˆäº†è§£ã€‚å¤§è‡´æµç¨‹æ˜¯ï¼š</p>

<div><pre><code class="language-none">* é‚®ä»¶äº¤æµï¼Œè®²è¿°ä½ çš„æƒ³æ³•ï¼Œå¦‚ä½•æ”¹åŠ¨ã€‚
* ä»¥ pr æ–¹å¼æäº¤ä½ çš„å»ºè®®ã€‚
* ä¸€æ—¦æ¥å—ï¼Œå¼€å§‹reviewã€‚
* é‚®ä»¶åˆ—è¡¨ä¸­reviewï¼Œæ¯”è¾ƒæ­£å¼ã€‚
* å¼€å‘å›¢é˜Ÿå†³æ–­ï¼Œæ‰“å›oræ¥å—ã€‚
* è¿™é‡Œæä¾›ææ¡ˆçš„åˆ—è¡¨ï¼Œç›®å‰æœ‰102ä¸ªï¼Œæœ‰å…´è¶£å¯ä»¥çœ‹çœ‹ï¼Œå®æ—¶å…³æ³¨swiftçš„åŠ¨æ€ã€‚</code></pre></div>

<p><img src="../images/session-402-3.png" alt=""></p>

<h2 id="toc_5">API Guidelines</h2>

<h3 id="toc_6">å…³äº swift çš„æ”¹åŠ¨</h3>

<p>Swift 3 çš„æ ¸å¿ƒä»»åŠ¡æˆ–è€…è¯´æ˜¯ç›®æ ‡æ˜¯æé«˜å…¼å®¹æ€§ï¼Œè¿™å¯¹äºè·¨å¹³å°å¼€å‘è‡³å…³é‡è¦ã€‚ä¸ä»…æ˜¯é’ˆå¯¹ Swift3ï¼Œäº¦åŒ…æ‹¬ Swift4.0 ç‰ˆæœ¬ã€‚</p>

<p>ä¸‹é¢æ ¹æ®è§†é¢‘ç®€å•ç½—åˆ—ä¸€äº›ï¼š</p>

<h3 id="toc_7">å‘½åå‡†åˆ™</h3>

<p>API è®¾è®¡å‡†åˆ™ä¸­é‡è¦å‡ ç‚¹ï¼š</p>

<p>ä¸€ç›®äº†ç„¶ï¼Œè€Œéè¿‡åˆ†ç®€æ´æˆ–å†—ä½™ã€‚
çªå‡ºé‡è¦ä¿¡æ¯
çœç•¥å†—ä½™ä¿¡æ¯
æ›´å¤šè¯·è§Api-design-guidelinesï¼Œè²Œä¼¼ Swift.gg å·²ç»æœ‰ä¸­æ–‡ç‰ˆäº†å“¦ã€‚</p>

<p>ä¸¾ä¾‹ï¼š</p>

<p>swift 2</p>

<div><pre><code class="language-none">// Swift.Array
array.appendContentsOf([2,3,4])
array.insert(1, atIndex: 0)

// Foundation.NSURL
if url.fileURL {}
x = url.URLByAppendingPathComponent(&quot;file.txt&quot;)</code></pre></div>

<p>swift3</p>

<div><pre><code class="language-none">// Swift.Array
array.append(contentsOf: [2,3,4]) // ä½œä¸ºæ ‡ç­¾å­˜åœ¨æ›´åŠ æ¸…æ™°
array.insert(1, at: 0) // index æ²¡æœ‰å­˜åœ¨çš„æ„ä¹‰

// Foundation.NSURL
if url.isFileURL {} // è¿™é‡Œå¹³å¸¸éƒ½ä¼šç”¨åˆ°å§
x = url.appendingPathComponent(&quot;file.txt&quot;)// éƒ½å·²ç»æ˜¯URL ä½•å¿…åŠ  URLByå‰ç¼€å‘¢</code></pre></div>

<p>å¾ˆæ˜æ˜¾æ”¹è¿›åè°ƒç”¨æ„å›¾ä¸å˜ï¼Œä½†æ˜¯ç²¾ç®€äº†å¾ˆå¤šã€‚</p>

<h3 id="toc_8">Objective-C API å’Œ Swift æ¡¥æ¥é—®é¢˜</h3>

<p>è¿™é‡Œæ¨è <a href="http://swift.gg/2016/06/20/SE-0005-better-translation-of-objective-c-api-into-swift/">swift.gg çš„SE-0005 æ›´å¥½çš„æŠŠ Objective-C APIs è½¬æ¢æˆ Swift ç‰ˆæœ¬</a>ã€‚</p>

<p>ç®€å•ä¸¾ä¾‹ï¼š</p>

<p>swift2</p>

<div><pre><code class="language-none">// oc
void CGContextFillPath(CGContextRef);//è¿™æ˜¯Core Graphic ç”»å›¾åº“ä¸­çš„å‡½æ•°ï¼ä¸æ˜¯æ–¹æ³•
// import è°ƒç”¨APIå˜æˆå¦‚ä¸‹ è¿˜æ˜¯ä¸€ä¸ªå‡½æ•°
func CGContextFillPath(_: CGContext)</code></pre></div>

<p>swift3</p>

<div><pre><code class="language-none">// oc
void CGContextFillPath(CGContextRef)
           NS_SWIFT_NAME(CGContext.fillPath(self:));// æ³¨æ„NS_SWIFT_NAMEä¿®é¥°ç¬¦
// å¯¹ CGContext æ‰©å±•
extension CGContext {
  func fillPath()
}</code></pre></div>

<p>åœ¨è¯´è¯´æ³›å‹:</p>

<p>swift2</p>

<div><pre><code class="language-none">func findAnimals() {
  let request = NSFetchRequest(entityName:â€Animal&quot;)
  guard let searchResults =
           try? context.executeFetchRequest(request) as! [Animal] {
    return
  }
  ...
  use(searchResults)
}</code></pre></div>

<p>swift3</p>

<div><pre><code class="language-none">func findAnimals() {
  let request : NSFetchRequest&lt;Animal&gt; = Animal.fetchRequest 
  guard let searchResults = try? context.fetch(request) {
    return
  }
  ...
  use(searchResults)
}</code></pre></div>

<p>æ—¨åœ¨å®ä¾‹åŒ–ä¸€ä¸ªå¯¹åä¸º Animal çš„ entity è¯·æ±‚ï¼Œä»¥å‰çš„å†™æ³•æ˜¯æ„é€ å‡½æ•°ï¼Œè€Œæ–°çš„æ˜¯ä¸Šè¿°è¿™ç§æ–¹å¼ï¼Œå·²æƒŠå‘†ã€‚</p>

<div><pre><code class="language-none">// oc 
typedef NSString *NSNotificationName; // å¯¹ NSString è®¾ç½®åˆ«å
const NSNotificationName NSUserDefaultsDidChangeNotification; // å˜é‡A

// swift å¯¼å…¥
let NSUserDefaultsDidChangeNotification: String // ocå˜é‡Aåœ¨swiftä¸­ å®é™…å°±æ˜¯Stringç±»å‹å˜›

// ä½¿ç”¨
center.addObserver(forName: NSUserDefaultsDidChangeNotification, ...) // å†—é•¿</code></pre></div>

<p>swift3</p>

<div><pre><code class="language-none">typedef NSString *NSNotificationName NS_EXTENSIBLE_STRING_ENUM; // æ³¨æ„ä¿®é¥°è¯ å˜æˆäº†ä¸€ä¸ªæšä¸¾å€¼.....
const NSNotificationName NSUserDefaultsDidChangeNotification;

// swift å¯¼å…¥
extension UserDefaults {
  class let didChangeNotification: NSNotification.Name
}

// ä½¿ç”¨1
center.addObserver(forName: UserDefaults.didChangeNotification, ...)
// ä½¿ç”¨2
center.addObserver(forName: .didChangeNotification, ...)</code></pre></div>

<h3 id="toc_9">æ ¸å¿ƒè¯­è¨€</h3>

<p>å‡½æ•°å‚æ•°æ ‡ç­¾çš„ä¸€è‡´æ€§
swift2</p>

<div><pre><code class="language-none">func myFunction(a: Int, b: Int, c: Int) { } 
myFunction(42, b: 57, c: 99)// æ²¡æœ‰ a æ ‡ç­¾å</code></pre></div>

<p>swift3</p>

<div><pre><code class="language-none">func myFunction(a: Int, b: Int, c: Int) { } 
myFunction(a: 42, b: 57, c: 99)
è¿™ä¸ªæ”¹åŠ¨åº”è¯¥å¾ˆæ—©å°±æåŠè¿‡ã€‚å¦‚æœä½ ä¸æ˜¯å¾ˆæ„¿æ„æ˜¾ç¤ºå‚æ•°æ ‡ç­¾ï¼Œç”¨ _ å¿½ç•¥å§ã€‚</code></pre></div>

<p>ä¸çŸ¥é“å¤§å®¶å¯¹ where è¿™ä¸ªæ¡ä»¶è¯­å¥ç”¨çš„å¤šä¸å¤šï¼Œswift3 ä¹Ÿåšå‡ºäº†äº›è®¸æ”¹åŠ¨ï¼Œä¸»è¦æ˜¯åœ¨æ”¾ç½®ä½ç½®ä¸Šã€‚</p>

<p>swift2</p>

<div><pre><code class="language-none">func anyCommon&lt;T: Sequence, U: Sequence
               where T.Element: Equatable,
                     T.Element == U.Element
               &gt;(lhs: T, rhs: U) -&gt; Bool {}</code></pre></div>

<p>æ³¨æ„æˆ‘ä»¬çš„å‡½æ•°åå’Œå‚æ•°åˆ—è¡¨ä¹‹é—´æºæ‚äº†å¤ªå¤šè¯­å¥äº†ï¼</p>

<p>swift3</p>

<div><pre><code class="language-none">func anyCommon&lt;T: Sequence, U: Sequence&gt;(lhs: T, rhs: U) -&gt; Bool 
          where T.Element: Equatable, T.Element == U.Element {}</code></pre></div>

<p>åœ¨æˆ‘ä»¬å†™å®Œå‡½æ•°å®šä¹‰ä¹‹åå†å†™é™åˆ¶æ¡ä»¶ whereã€‚å¾ˆnice!</p>

<p>å†æ¥çœ‹çœ‹å¯¹æœªä½¿ç”¨å˜é‡çš„å¤„ç†</p>

<p>swift2</p>

<div><pre><code class="language-none">func plusOne(_ a: Int) -&gt; Int {
  return a+1
}
plusOne(x)// å‘å‡ºâš ï¸è­¦å‘Šï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°æ˜¯æœ‰è¿”å›å€¼</code></pre></div>

<p>swift3</p>

<div><pre><code class="language-none">@discardableResult
func plusOne(_ a: Int) -&gt; Int {
  print(a)     // side effect!
  return a+1
}
plusOne(x)
_ = plusOne(x)</code></pre></div>

<p>æ³¨æ„@discardableResult ä¿®é¥°ç¬¦ã€‚</p>

<h3 id="toc_10">Swift3 ç§»é™¤çš„ç‰¹æ€§</h3>

<p>ç§»é™¤ä¸œè¥¿å¯èƒ½è®©ä½ æƒ¶æä¸å®‰ï¼Œä½†æ˜¯è¿™ä¹Ÿæ˜¯è‹¹æœæ·±æ€ç†Ÿè™‘ï¼Œæƒè¡¡ä¼—å¤šå¼€å‘è€…æå‡ºçš„æ„è§ä¹‹ååšå‡ºçš„å†³å®šã€‚ç›®çš„æœ‰ä¸‰ï¼š</p>

<div><pre><code class="language-none">* è‡´åŠ›äºç®€åŒ–è¯­è¨€
* å‡å°‘ä»£ç ä¸Šæ‰‹éš¾åº¦
* å‘å…¶ä»–è¯­è¨€å­¦ä¹ ï¼Œå–å…¶ç²¾åï¼Œå»å…¶ç³Ÿç²•</code></pre></div>

<p>ç›®å‰æœ‰å“ªäº›ç§»é™¤äº†çš„å‘¢ï¼Ÿ</p>

<div><pre><code class="language-none">SE-0002 Currying func declaration syntax
SE-0003 å‡½æ•°å‚æ•°åˆ—è¡¨ä¸­çš„ var
SE-0004 ++ å’Œ -- è¿ç®—ç¬¦
SE-0007 C è¯­è¨€ä¸­çš„ for å¾ªç¯</code></pre></div>

<p>åˆæœ‰å“ªäº›æ–°åŠ å…¥çš„å‘¢ï¼Ÿ</p>

<div><pre><code class="language-none">SE-0025 åŠ å…¥ fileprivate ä½œç”¨åŸŸèŒƒå›´ï¼Œå’±ä»¬ç”¨çš„æ¯”è¾ƒå¤šçš„æ˜¯ public private
SE-0043 case æ ‡ç­¾çš„å€¼ç»‘å®šæ“ä½œ
SE-0048 æ³›å‹åˆ«åï¼Œè²Œä¼¼æ˜¯associatedTypeã€‚</code></pre></div>

<p>å…¶ä»–è¿˜æœ‰ SE-0062 SE-0064 SE-0068 SE-0075 SE-0092ï¼Œä¸å¦¨å» GitHub ä¸Šä¸€ç¹ä¸ºå¿«å§ã€‚</p>

<p>ä¿®æ”¹åˆæœ‰å“ªäº›å‘¢ï¼Ÿ</p>

<div><pre><code class="language-none">SE-0028 #file æ›¿æ¢äº† FILE
SE-0031 inout å˜æˆäº†ç±»å‹çš„ä¸€éƒ¨åˆ†
SE-0040 å±æ€§è¯­æ³•ï¼š :æ›¿æ¢=
SE-0049 @noescape å’Œ @autoclosure å¯ä»¥ç±»å‹å±æ€§
SE-0060 dynamicType ä¸å†æ˜¯å±æ€§ è€Œæ˜¯è¿ç®—ç¬¦ã€‚</code></pre></div>

<h3 id="toc_11">ç±»å‹ç³»ç»Ÿçš„æ”¹å˜</h3>

<p>å…ˆçœ‹ä¸€åˆ™ swift2 çš„ä¾‹å­ï¼š</p>

<div><pre><code class="language-none">let ptr : UnsafeMutablePointer&lt;Int&gt; = nil
if ptr != nil {
   ptr.memory = 42
}</code></pre></div>

<p>è€Œåœ¨swift3 ä¸­åˆ™æ˜¯è¿™æ ·å¹²</p>

<div><pre><code class="language-none">let ptr : UnsafeMutablePointer&lt;Int&gt;? = nil 
ptr?.memory = 42</code></pre></div>

<blockquote>
<p>Imported C pointers in APIs obey _Nullable and <em>Null</em>unspecified
Consistency: nil is dedicated to Optional and ImplicitlyUnwrappedOptional
éšå¼è§£åŒ…å¯é€‰ç±»å‹ï¼ˆIUO Implicitly Unwrapped OptionaLï¼‰</p>
</blockquote>

<p>swift2 ä¸­ç±»å‹ç³»ç»Ÿæ˜¯è¿™ä¹ˆæ¨æ–­çš„ï¼š</p>

<div><pre><code class="language-none">func f(value : Int!) {
  let x = value + 1  // x: Int - å¼ºåˆ¶è§£åŒ…çš„ç»“æœ
  let y = value      // y: Int!
  let array = [value, 42] // [Int], [Int!], [Int?], [Any]... å®ƒæ— æ³•æ¨æ–­ç±»å‹äº† å› ä¸ºå®ƒä¸çŸ¥é“yåˆ°åº•æ˜¯æœ‰å€¼å‘¢è¿˜æ˜¯nilå‘¢
   use(array) //Cannot convert value of type â€˜[Int!]â€™ to argument type
}</code></pre></div>

<p>swift3 ä¸­ç±»å‹ç³»ç»Ÿå°±èªæ˜å¾ˆå¤šäº†ï¼š</p>

<div><pre><code class="language-none">func f(value : Int!) {
  let x = value + 1  // x: Int - å¼ºåˆ¶è§£åŒ…çš„ç»“æœ
  let y = value      // y: Intï¼Ÿ
  let array = [value, 42] // [Int?], 
   use(array) 
}</code></pre></div>

<h3 id="toc_12">æµ®ç‚¹æ•°å’Œæ•°å­—</h3>

<p>ç›´æ¥ä¸Šä»£ç ï¼š</p>

<div><pre><code class="language-none">// swift2
let v = 2 * Float(M_PI)
return x * CGFloat(M_PI) / 180

// swift3
let v = 2 * Float.pi
return x * CGFloat.pi / 180
return x * .pi / 180      // amazing!</code></pre></div>

<h2 id="toc_13">Swift Tools</h2>

<p>Swiftæ˜¯ä¸€ä¸ªå¼€å‘è¯­è¨€ï¼Œå†™ä»£ç å¤§éƒ¨åˆ†éƒ½ä½¿ç”¨å¥½ç”¨çš„å¼€å‘å·¥å…·ä¾‹å¦‚è‹¹æœæä¾›çš„Xcodeï¼ä½¿ç”¨å·¥å…·ä¼šå½±å“ä½ ä»¬æ¯å¤©å†™Swiftä»£ç çš„æ•ˆç‡ã€‚</p>

<p>Swift3ä¿®å¤äº†ä¸€äº›bugåœ¨ç¼–è¯‘å™¨å’ŒIDEçš„åŠŸèƒ½ä½¿ç”¨ä¸­ã€‚å®ƒä¹Ÿæé«˜äº†é”™è¯¯å’Œè­¦å‘Šæ¶ˆæ¯çš„ç²¾åº¦ï¼Œæ­£å¦‚ä½ æ‰€æ–™ï¼Œæ¯ä¸ªç‰ˆæœ¬çš„å‘å¸ƒSwiftå°†ä¼šå˜å¾—æ›´å¿«ï¼š</p>

<div><pre><code class="language-none">é€šè¿‡æ”¹å–„å­—ç¬¦ä¸²å“ˆå¸Œèƒ½å¤Ÿæé«˜3*çš„é€Ÿåº¦åœ¨å­—å…¸å­—ç¬¦ä¸²ä¸­ã€‚
é€šè¿‡ç§»åŠ¨å¯¹è±¡ä»ä¸€ä¸ªå †åˆ°æ ˆä¸Šæœ‰24*çš„æé«˜(æœ‰äº›æƒ…å†µä¸‹)
ç°åœ¨çš„ç¼–è¯‘å™¨ä¸€æ¬¡ç¼“å­˜å¤šä¸ªæ–‡ä»¶ï¼ˆæ•´ä¸ªæ¨¡å—ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼‰
ä»£ç å¤§å°ä¼˜åŒ–å·²ç»å‡å°‘äº†Swiftä»£ç ç¼–è¯‘çš„å¤§å°ã€‚è‹¹æœçš„æ¼”ç¤º Demobotså‡å°‘ç¼–è¯‘å¤§å°åˆ°åŸæ¥çš„77ï¼…</code></pre></div>

<p>Xcodeä¼šè‡ªåŠ¨æ¨æ–­æœ¬åœ°çš„Swiftæ¥ä¸‹æ¥ä¼šåšä»€ä¹ˆï¼š</p>

<p>å½“ä½ åœ¨ä¸€ä¸ªAPIçš„æ–¹æ³•ä¸Šå³å‡»åƒsort(),å®ƒå°±ä¼šè·³åˆ°å¯¹åº”çš„å®šä¹‰ä¸­ï¼Œä½ èƒ½çœ‹åˆ°å®ƒçš„å¤´æ–‡ä»¶å®šä¹‰ã€‚ç°åœ¨ï¼Œæ­£å¦‚ä½ æœŸæœ›çš„ä¸€æ ·åœ¨Xcode8ä¸­ä½ èƒ½çœ‹åˆ°sort()æ˜¯Arrayçš„æ‰©å±•ã€‚</p>

<p><code>Swift Snapshots</code>ä¹Ÿä¼šéšç€Swiftçš„å‘å±•å‘å¸ƒã€‚ä»–ä»¬æä¾›äº†ä¸€ä¸ªæœºä¼šå†å’Œæ–°è¯­æ³•åˆå¹¶ä¹‹å‰ï¼Œå®Œå…¨è¢«é›†æˆåœ¨Xcodeä¸­ã€‚Xcode8èƒ½åŠ è½½å’Œè¿è¡ŒSwift Snapshotsåœ¨playgroundä¸Šã€‚</p>

<h2 id="toc_14">migrating to Swift 3.0</h2>

<p>é’ˆå¯¹ç›®å‰çš„ç°çŠ¶æ¥è¯´ï¼ŒSwift3åªæ˜¯betaç‰ˆï¼Œè¿˜åœ¨æµ‹è¯•é˜¶æ®µï¼Œæ‰€ä»¥ç°åœ¨å°†ä»£ç è¿ç§»åˆ°swift3.0è¿˜æ˜¯ä¸æ˜æ™ºçš„ï¼Œè‡³å°‘åœ¨ä»£ç å®¡æ ¸çš„æ—¶å€™å°±ä¼šæ¯”è¾ƒéº»çƒ¦ï¼ŒåŒæ—¶æ–°çš„Xcode8 betaå¯¹æ–°è¯­è¨€çš„æ”¯æŒä¹Ÿæ¯”è¾ƒè¿Ÿé’ã€‚è¿˜æ˜¯ç­‰Xcodeè¿‡åº¦åˆ°ç¨³å®šç‰ˆæœ¬ï¼Œswiftå‘å¸ƒæ­£å¼3.0ç‰ˆæœ¬åœ¨åšè¿ç§»å§ï¼ï¼ï¼</p>

<p>å¯¹äºæƒ³å°é²œçš„åŒå­¦æ¥è¯´ï¼Œå¯ä»¥æš‚æ—¶å°†ä»£ç è¿ç§»åˆ°Swift2.3çš„ç‰ˆæœ¬ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¯´ä¸€ä¸‹ä»€ä¹ˆSwift2.3åŒ…å«äº†ä»€ä¹ˆ</p>

<div><pre><code class="language-none">Swift2.2 + New SDKs = Swift2.3
Build, test, and submit to App Store fully supported
Playgrounds and documentation depend on Swift 3
Interim solution until you migrate to Swift 3</code></pre></div>

<p>æ‰€ä»¥å½“æˆ‘ä»¬æŠŠå½“å‰å·¥ç¨‹çš„è¿ç§»è‡³Swift2.3æ˜¯æœ€å¥½çš„é€‰æ‹©ï¼Œè¿™æ ·å½“Swiftå‘å¸ƒäº†æœ€æ–°çš„Swift3ä¹‹åï¼Œé€‰æ‹©Xcode-&gt;edit-&gt;Convert-&gt;To Current Swift Syntax... å°±å¯ä»¥å°†å·¥ç¨‹è¿ç§»è‡³Swift3äº†</p>

<h2 id="toc_15">æ›´å¤šå†…å®¹</h2>

<p>æœ¬æ¬¡Sessionä¸­åªå®½æ³›çš„è®²è¿°äº†Swift3ä¸­çš„å˜åŒ–ï¼Œå¦‚æœæƒ³äº†è§£æ›´å¤šçš„ç»†èŠ‚ã€‚è¯·åˆ°ä¸‹é¢åˆ—å‡ºçš„Sessionä¸­å»äº†è§£æ›´å¤š</p>

<p><img src="../images/session-402-4.png" alt=""></p>

<h3 id="toc_16">å‚è€ƒ</h3>

<p><a href="https://developer.apple.com/videos/play/wwdc2016/402/">WWDC Session 402</a></p>

<p><a href="http://www.jianshu.com/p/c096e971ad3e">What&#39;s New in Swift 3?</a></p>

<p><a href="http://www.jianshu.com/p/22366f1fca4a">WWDC2016 Session 402 - Whatâ€™s New in Swift</a></p>




</body>

</html>
